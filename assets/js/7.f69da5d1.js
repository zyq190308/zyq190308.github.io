(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{405:function(s,a,e){s.exports=e.p+"assets/img/docker.78837ccd.png"},406:function(s,a,e){s.exports=e.p+"assets/img/docker2.5f01290b.png"},423:function(s,a,e){"use strict";e.r(a);var t=e(44),r=Object(t.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"docker-学习记录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-学习记录"}},[s._v("#")]),s._v(" docker 学习记录")]),s._v(" "),t("h2",{attrs:{id:"开始"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#开始"}},[s._v("#")]),s._v(" 开始")]),s._v(" "),t("p",[s._v("从这段docker命令开始：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker run -d -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(":80 docker/getting-started\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[t("code",[s._v("-d")]),s._v(" - 在后台运行容器")]),s._v(" "),t("li",[t("code",[s._v("-p 80:80")]),s._v(" - 把主机的80端口映射到容器的80端口")]),s._v(" "),t("li",[t("code",[s._v("docker/getting-started")]),s._v(" - 使用的镜像")])]),s._v(" "),t("p",[s._v("可以组合单个字符标志来缩短完整命令。例如，上面的命令可以写为：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker run -dp "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(":80 docker/getting-started\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"什么是容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#什么是容器"}},[s._v("#")]),s._v(" 什么是容器")]),s._v(" "),t("p",[s._v("简而言之，容器只是您计算机上的另一个进程，已与主机上的所有其他进程隔离。这种隔离利用了Linux上已有很长时间的"),t("code",[s._v(" kernel namespaces and cgroups")]),s._v("。 Docker致力于使这些功能更易于使用。")]),s._v(" "),t("h2",{attrs:{id:"什么是容器镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#什么是容器镜像"}},[s._v("#")]),s._v(" 什么是容器镜像")]),s._v(" "),t("p",[s._v("运行容器时，它使用隔离的文件系统。此自定义文件系统由容器镜像提供。由于镜像包含容器的文件系统，因此它必须包含运行应用程序所需的所有内容-所有依赖项，配置，脚本，二进制文件等。镜像还包含容器的其他配置，例如环境变量，要运行的默认命令以及其他元数据。")]),s._v(" "),t("h2",{attrs:{id:"构建应用镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#构建应用镜像"}},[s._v("#")]),s._v(" 构建应用镜像")]),s._v(" "),t("p",[s._v("为了构建应用程序，我们需要使用Dockerfile。 Dockerfile只是基于文本的指令脚本，用于创建容器镜像。如果您以前创建过Dockerfile，则可能会在下面的Dockerfile中看到一些缺陷。但是，不用担心！我们将跳过它们。")]),s._v(" "),t("ol",[t("li",[s._v("在项目根路径下创建一个名为Dockerfile的文件。")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("FROM node:12-alpine\nWORKDIR /app\nCOPY "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\nRUN "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" --production\nCMD "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"src/index.js"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[s._v("现在使用docker build命令构建容器映像。")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker build -t getting-started "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("-t标志标记我们的图像。可以简单地将其视为最终图像的易于理解的名称。由于我们将镜像命名为getting-started，因此我们可以在运行容器时引用该镜像。docker build命令末尾的"),t("code",[s._v(".")]),s._v("告诉Docker应该在当前目录中查找Dockerfile。")]),s._v(" "),t("h2",{attrs:{id:"启动一个容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动一个容器"}},[s._v("#")]),s._v(" 启动一个容器")]),s._v(" "),t("ol",[t("li",[s._v("使用"),t("code",[s._v("docker run")]),s._v("命令启动容器，并指定我们刚刚创建的镜像的名称：")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("docker run -dp 3000:3000 getting-started\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[s._v("打开Web浏览器到http://localhost：3000，此时我们APP就启动了！")])]),s._v(" "),t("h2",{attrs:{id:"更新应用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#更新应用"}},[s._v("#")]),s._v(" 更新应用")]),s._v(" "),t("p",[s._v("更新代码后，然后重新打包镜像：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker build -t getting-started "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("重新启动容器：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker run -dp "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),s._v(":3000 getting-started\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("然后就会出现这个错误：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("docker: Error response from daemon: driver failed programming external connectivity on endpoint silly_thompson (4d33de77d79245a22c03fb1776154b6fa7eea6218c3111698ac59850d0f80776): Bind for 0.0.0.0:3000 failed: port is already allocated.\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("我们不能启动新容器，因为我们旧的容器还在运行，端口还被占用着。要修复这个问题，必须先移除旧容器。")]),s._v(" "),t("h2",{attrs:{id:"移除旧容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#移除旧容器"}},[s._v("#")]),s._v(" 移除旧容器")]),s._v(" "),t("p",[s._v("为了移除旧容器，首先得让它停止。有两种移除旧容器的方法。")]),s._v(" "),t("ol",[t("li",[s._v("使用"),t("code",[s._v("docker ps")]),s._v("命令获取容器的ID。")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[s._v("使用"),t("code",[s._v("docker stop")]),s._v("命令停止容器。")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker stop "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("the-container-id"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"3"}},[t("li",[s._v("容器停止后，您可以使用"),t("code",[s._v("docker rm")]),s._v("命令将其删除。")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("the-container-id"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("blockquote",[t("p",[s._v("您可以通过在docker rm命令中添加“ force”标志来在单个命令中停止和删除容器。例如：docker rm -f <容器标识符>")])]),s._v(" "),t("h2",{attrs:{id:"分享你的应用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#分享你的应用"}},[s._v("#")]),s._v(" 分享你的应用")]),s._v(" "),t("h3",{attrs:{id:"创建一个仓库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建一个仓库"}},[s._v("#")]),s._v(" 创建一个仓库")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("Go to Docker Hub and log in if you need to.")])]),s._v(" "),t("li",[t("p",[s._v("Click the Create Repository button.")])]),s._v(" "),t("li",[t("p",[s._v("For the repo name, use getting-started. Make sure the Visibility is Public.")])]),s._v(" "),t("li",[t("p",[s._v("Click the Create button!")])])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker push zyq190308/getting-started:tagname\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"推送镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#推送镜像"}},[s._v("#")]),s._v(" 推送镜像")]),s._v(" "),t("ol",[t("li",[s._v('在命令行中，尝试运行在Docker Hub上看到的push命令。请注意，您的命令将使用名称空间，而不是"docker"。')])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker push zyq190308/getting-started\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[t("p",[s._v("docker login -u zyq190308")])]),s._v(" "),t("li",[t("p",[s._v("使用docker tag命令为新镜像起一个新名称。确保用您的Docker ID交换您的用户名。")])])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker tag getting-started zyq190308/getting-started\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"4"}},[t("li",[s._v("现在，再次尝试您的推送命令。如果要从Docker Hub复制值，则可以删除标记名部分，因为我们没有在镜像名称中添加标记。如果您不指定标签，则Docker将使用一个名为Latest的标签。")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker push zyq190308/getting-started\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"在新实例上运行镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#在新实例上运行镜像"}},[s._v("#")]),s._v(" 在新实例上运行镜像")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://labs.play-with-docker.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("线上使用docker地址"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("后台如下图：\n"),t("img",{attrs:{src:e(405),alt:"docker"}})]),s._v(" "),t("p",[s._v("启动我们的APP：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker run -dp "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),s._v(":3000 zyq190308/getting-started\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("如下图：\n"),t("img",{attrs:{src:e(406),alt:"docker2"}})]),s._v(" "),t("p",[s._v("然后就可以点击图上的3000端口就可以看到效果了。")])])}),[],!1,null,null,null);a.default=r.exports}}]);